angular.module("ask.bootstrap",["ask.bootstrap.controllers","ask.bootstrap.directives","ask.bootstrap.filters","ask.bootstrap.templates"]),angular.module("ask.bootstrap.controllers",["angular-mood","ui.bootstrap"]).controller("MoodDialogCtrl",function(a,b,c,d){a.mood=_.clone(d),a.$watch("mood",function(){console.log("Mood changed"),console.log(d)}),a.getStyle=function(a){return a?{color:MoodGrid.getColor(a.valence,a.arousal)}:void 0},a.ok=function(){b.close(a.mood)},a.cancel=function(){b.dismiss("cancel")}}),angular.module("ask.bootstrap.directives",["ngAnimate","angular-mood","ui.bootstrap","ask-logic"]).directive("askSurvey",["$log","SurveyStates",function(a,b){return{restrict:"E",scope:{survey:"=",response:"="},templateUrl:"ask.bootstrap.survey.tmpl.html",link:function(c,d,e){c.$watch("survey",function(){c.survey&&(a.debug("handing survey changed"),c.state=b.init(c.survey,c.response))},!0),c["continue"]=function(){a.debug("attempting to continue"),a.debug(c.state),c.state.handleContinue()},c.back=function(){a.debug("attempting to go back"),a.debug(c.state),c.state.handleBack()},c.onFirstPage=function(){return c.response?0==c.response.pageIndex:void 0},c.onLastPage=function(){return c.response&&c.state?c.response.pageIndex==c.state.pages.length-1:void 0}}}}]).directive("askField",["$log","PlaceholderResolver",function(a,b){return{restrict:"E",scope:{field:"=",answer:"=",state:"=",response:"="},templateUrl:"ask.bootstrap.field.tmpl.html",link:function(c,d,e){c.$watch("answer",function(){a.debug("answer updated for field "+c.field.id),c.state.handleAnswerChanged(c.field.id)},!0),c.resolvePlaceholders=function(a){return a?b.resolve(a,c.state,c.response):a}}}}]).directive("askFreetext",function(){return{restrict:"E",templateUrl:"ask.bootstrap.field.freetext.tmpl.html",link:function(a,b,c){}}}).directive("askMultitext",function(){return{restrict:"E",templateUrl:"ask.bootstrap.field.multitext.tmpl.html",link:function(a,b,c){function d(){if(console.log("Handling entries changed"),a.answer.entries&&f()){console.log("updating temp entries to match entries");var b=[];_.each(a.answer.entries,function(a){b.push({text:a})});var c=1;for(a.field.minEntries&&(c=a.field.minEntries);b.length<c;)b.push({text:""});a.tempEntries=b}}function e(){if(console.log("handling temp entries changed"),f()){console.log("updating entries to match temp entries");var b=[];_.each(a.tempEntries,function(a){b.push(a.text)}),a.answer.entries=b}}function f(){if(console.log("checking cache"),console.log(a.tempEntries),console.log(a.answer.entries),!a.tempEntries)return!0;if(!a.answer.entries)return!0;if(a.tempEntries.length!=a.answer.entries.length)return!0;for(var b=0;b<a.tempEntries.length;b++)if(a.tempEntries[b].text!=a.answer.entries[b])return!0;return!1}a.tempEntries=void 0,a.$watch("answer.entries",d,!0),a.$watch("tempEntries",e,!0),a.canAdd=function(){return a.field.maxEntries?a.answer.entries.length<a.field.maxEntries:!0},a.add=function(){a.tempEntries.push({text:""})},a.remove=function(b){console.log("removing "+b),a.tempEntries.splice(b,1)}}}}).directive("askSinglechoice",function(a){return{restrict:"E",templateUrl:"ask.bootstrap.field.singlechoice.tmpl.html",link:function(a,b,c){}}}).directive("askMultichoice",function(){return{restrict:"E",templateUrl:"ask.bootstrap.field.multichoice.tmpl.html",link:function(a,b,c){a.answer.choices||(a.answer.choices=[]),a.isChecked=function(b){return!a.answer||a.answer.choices?!1:a.answer.choices.indexOf(b.name)>-1},a.toggle=function(b){var c=a.answer.choices.indexOf(b.name);c>-1?a.answer.choices.splice(c,1):a.answer.choices.push(b.name)}}}}).directive("askNumeric",function(){return{restrict:"E",templateUrl:"ask.bootstrap.field.numeric.tmpl.html",link:function(a,b,c){}}}).directive("askRating",function(){return{restrict:"E",templateUrl:"ask.bootstrap.field.rating.tmpl.html",link:function(a,b,c){function d(){console.log("updating star fills"),_.each(a.choices,function(a){a.isFilled=e(a)})}function e(b){return a.$parent.answer&&a.$parent.answer.rating>=b.rating?!0:!1}a.$watch("field",function(){if(a.field){a.choices=[];for(var b=0;b<a.field.length;b++){var c={rating:b+1};a.field.descriptions&&(c.description=a.field.descriptions[b]),c.isFilled=!1,a.choices.push(c)}a.cellWidth=Math.floor(100/a.choices.length)+"%"}},!0),a.setChoice=function(b){a.$parent.answer.rating=b?b.rating:void 0,a.selectedChoice=b,d()},a.hoverChoice=function(b){a.hoveredChoice=b}}}}).directive("askMood",["MoodData","$modal",function(a,b){return{restrict:"E",templateUrl:"ask.bootstrap.field.mood.tmpl.html",link:function(c,d,e){c.setMood=function(){var a=b.open({templateUrl:"ask.bootstrap.dlg.mood.tmpl.html",controller:"MoodDialogCtrl",size:"sm",resolve:{mood:function(){return c.answer.mood}}});a.result.then(function(a){c.answer.mood=a})},c.moodStyle=function(b){return b?{color:a.getColor(b.valence,b.arousal)}:{}}}}}]),angular.module("ask.bootstrap.filters",[]).filter("markdown",function(){var a=new Showdown.converter;return function(b){return b?a.makeHtml(b):void 0}}),angular.module("ask.bootstrap.templates",["ask.bootstrap.dlg.mood.tmpl.html","ask.bootstrap.field.freetext.tmpl.html","ask.bootstrap.field.mood.tmpl.html","ask.bootstrap.field.multichoice.tmpl.html","ask.bootstrap.field.multitext.tmpl.html","ask.bootstrap.field.numeric.tmpl.html","ask.bootstrap.field.rating.tmpl.html","ask.bootstrap.field.singlechoice.tmpl.html","ask.bootstrap.field.tmpl.html","ask.bootstrap.survey.tmpl.html"]),angular.module("ask.bootstrap.dlg.mood.tmpl.html",[]).run(["$templateCache",function(a){"use strict";a.put("ask.bootstrap.dlg.mood.tmpl.html",'<div class=modal-body><div><mood-canvas selected hovered=hoveredInCanvas></mood-canvas></div><div><mood-matrix selected hovered-in-canvas=hoveredInCanvas hovered-in-matrix=hoveredInMatrix></mood-matrix></div>mood: {{mood}}</div><div class=modal-footer><button class="btn btn-primary" ng-click=ok()>Ok</button> <button class="btn btn-default" ng-click=cancel()>Cancel</button></div>')}]),angular.module("ask.bootstrap.field.freetext.tmpl.html",[]).run(["$templateCache",function(a){"use strict";a.put("ask.bootstrap.field.freetext.tmpl.html",'<div ng-switch=field.length><textarea ng-switch-when=LONG ng-model=answer.text class=form-control rows=3>\n	</textarea><input ng-switch-when=SHORT ng-model=answer.text class="form-control"></div>')}]),angular.module("ask.bootstrap.field.mood.tmpl.html",[]).run(["$templateCache",function(a){"use strict";a.put("ask.bootstrap.field.mood.tmpl.html",'<div class="form-control clickable" ng-click=setMood()><strong ng-show=answer.mood ng-style=moodStyle(answer.mood)>{{answer.mood.name}}</strong></div>')}]),angular.module("ask.bootstrap.field.multichoice.tmpl.html",[]).run(["$templateCache",function(a){"use strict";a.put("ask.bootstrap.field.multichoice.tmpl.html",'<div><div ng-repeat="choice in field.choices" class=checkbox><label><input type=checkbox ng-checked=isChecked(choice) ng-click="toggle(choice)"> {{choice.name}} <span ng-show=choice.description class="text-muted small">({{choice.description}})</span></label></div></div>')}]),angular.module("ask.bootstrap.field.multitext.tmpl.html",[]).run(["$templateCache",function(a){"use strict";a.put("ask.bootstrap.field.multitext.tmpl.html",'<div><div ng-repeat="entry in tempEntries" style="padding-bottom: 5px"><div style="display: table-cell ; width: 100%" ng-switch=field.length><textarea ng-switch-when=LONG ng-model=entry.text class=form-control rows=3>\n			</textarea><input ng-switch-when=SHORT ng-model=entry.text class="form-control"></div><div style="display: table-cell ; vertical-align:middle ; padding-left: 10px"><a ng-click=remove($index)><i class="fa fa-times-circle"></i></a></div></div><p ng-show=canAdd()><a ng-click=add()><i class="fa fa-times-circle"></i> More</a></p></div>')}]),angular.module("ask.bootstrap.field.numeric.tmpl.html",[]).run(["$templateCache",function(a){"use strict";a.put("ask.bootstrap.field.numeric.tmpl.html",'<div><input type=number ng-model=answer.number class="form-control"></div>')}]),angular.module("ask.bootstrap.field.rating.tmpl.html",[]).run(["$templateCache",function(a){"use strict";a.put("ask.bootstrap.field.rating.tmpl.html",'<div><div ng-if="field.ratingType==&quot;radio&quot;"><div ng-if="field.descriptions.length == field.length" style=display:table><div ng-repeat="choice in choices" style="width:{{cellWidth}} ; display:table-cell ; text-align:center"><input type=radio ng-model=$parent.answer.rating ng-value="choice.rating"><br><span class=text-muted style="padding: 0px 10px">{{choice.description}}</span></div></div><div ng-if="field.descriptions.length != field.length && field.descriptions.length == 2"><span class="radio-inline text-muted" style="cursor: default ; margin-left: 0px ; padding-left: 0px ; padding-right: 20px">{{field.descriptions[0]}} &nbsp;</span><label class=radio-inline style="padding: 0px 5px" ng-repeat="choice in choices"><input type=radio ng-model=$parent.answer.rating ng-value="choice.rating"> &nbsp;</label><span class="radio-inline text-muted" style="cursor: default ; margin-left: 0px ; padding-left: 0px">{{field.descriptions[1]}}</span></div></div><div ng-if="field.ratingType==&quot;star&quot;"><span ng-repeat="choice in choices" ng-click=setChoice(choice) ng-mouseover=hoverChoice(choice) ng-mouseout=hoverChoice() style=cursor:pointer><i class="fa fa-star" ng-show=choice.isFilled></i> <i class="fa fa-star-o" ng-hide=choice.isFilled></i></span> <span ng-show=hoveredChoice>&nbsp; {{hoveredChoice.description}}</span> <span ng-show="!hoveredChoice && selectedChoice">&nbsp; {{selectedChoice.description}}</span></div></div>')}]),angular.module("ask.bootstrap.field.singlechoice.tmpl.html",[]).run(["$templateCache",function(a){"use strict";a.put("ask.bootstrap.field.singlechoice.tmpl.html",'<div><div ng-repeat="choice in field.choices" class=radio><label><input type=radio ng-model=$parent.answer.choice ng-value="choice.name"> {{choice.name}} <span ng-show=choice.description class=small>{{choice.description}}</span></label></div></div>')}]),angular.module("ask.bootstrap.field.tmpl.html",[]).run(["$templateCache",function(a){"use strict";a.put("ask.bootstrap.field.tmpl.html",'<div class="field form-group"><div ng-if=!field.isQuestion><div ng-if="field.type == &quot;sectionBreak&quot;"><hr><h3>{{field.title}}</h3></div><p ng-show=field.text class=text ng-bind-html="resolvePlaceholders(field.text) | markdown"></p><p ng-show=field.notes class="notes text-muted" ng-bind-html="resolvePlaceholders(field.notes) | markdown"></p></div><div ng-if=field.isQuestion><div class=pull-left><i class="fa fa-exclamation-circle fa-lg text-danger" ng-show=field.missing></i> <i class="fa fa-circle" ng-show="!field.missing && !field.optional"></i> <i class="fa fa-circle-o" ng-show="!field.missing && field.optional"></i> &nbsp;</div><p class="question indent" ng-class="(field.missing) ? &quot;text-danger&quot; : &quot;&quot;" ng-bind-html="resolvePlaceholders(field.question) | markdown"></p><p ng-show=field.notes class="notes text-muted indent" ng-bind-html="resolvePlaceholders(field.notes) | markdown"></p><p ng-switch=field.type class=indent><ask-instruction ng-switch-when=instruction></ask-instruction><ask-freetext ng-switch-when=freetext></ask-freetext><ask-multitext ng-switch-when=multitext></ask-multitext><ask-numeric ng-switch-when=numeric></ask-numeric><ask-singlechoice ng-switch-when=singlechoice></ask-singlechoice><ask-multichoice ng-switch-when=multichoice></ask-multichoice><ask-rating ng-switch-when=rating></ask-rating><ask-mood ng-switch-when=mood></ask-mood></p></div></div>')}]),angular.module("ask.bootstrap.survey.tmpl.html",[]).run(["$templateCache",function(a){"use strict";a.put("ask.bootstrap.survey.tmpl.html",'<div class=ask-survey><h2>{{survey.title}}</h2><br><div ng-show=response.completed><div ng-show=survey.completionMessage ng-bind-html="survey.completionMessage | markdown"></div><div ng-hide=survey.completionMessage>Thank you!</div></div><div ng-hide=response.completed><ul class=page-header ng-show="state.pages.length > 1"><li ng-repeat="page in state.pages" ng-class="{current: page.current}"><span class="fa-stack fa-lg" ng-hide=page.current><i class="fa fa-circle-thin fa-stack-2x"></i> <i class="fa fa-stack-1x"><strong>{{page.pageIndex+1}}</strong></i></span> <span class="fa-stack fa-lg" ng-show=page.current><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-inverse fa-stack-1x"><strong>{{page.pageIndex+1}}</strong></i></span> {{page.title}}</li></ul><div ng-repeat="field in state.fields"><ask-field field=field answer=response.answers[field.id] state=state response=response ng-if=field.visible></ask-field></div><div class=text-center><hr><p class=pull-right ng-show="state.pages.length > 1"><span class=text-muted>page</span> {{response.pageIndex+1}} <span class=text-muted>of</span> {{state.pages.length}}</p><a class="btn btn-default" ng-click=back() ng-hide=onFirstPage()><span class="glyphicon glyphicon-circle-arrow-left" aria-hidden=true></span> &nbsp; Go Back</a> <a class="btn btn-default" ng-click=continue() ng-show=onLastPage()>Finish</a> <a class="btn btn-default" ng-click=continue() ng-hide=onLastPage()>Continue &nbsp; <span class="glyphicon glyphicon-circle-arrow-right" aria-hidden=true></span></a></div></div></div>')}]);